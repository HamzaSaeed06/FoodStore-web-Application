<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vendor Dashboard - FoodStore</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="vendor.css">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>

    <!-- Sidebar -->
    <aside class="admin-sidebar">
        <div class="sidebar-header">
            <a href="#" class="sidebar-logo">FoodStore.</a>
        </div>

        <nav class="sidebar-nav">
            <a href="#" class="nav-item active" onclick="switchTab('shop')">
                <i data-lucide="store" class="nav-icon"></i>
                <span>My Shop</span>
            </a>
            <a href="#" class="nav-item" onclick="switchTab('items')">
                <i data-lucide="package" class="nav-icon"></i>
                <span>Menu Items</span>
            </a>
            <a href="#" class="nav-item" onclick="switchTab('orders')">
                <i data-lucide="shopping-bag" class="nav-icon"></i>
                <span>Orders</span>
                <span class="order-badge" id="newOrdersBadge" style="display: none;">0</span>
            </a>
        </nav>

        <div class="sidebar-bottom">
            <div class="admin-user-profile mobile-profile">
                <div class="avatar" id="mobileAvatar"><img src="" alt="Profile"></div>
                <div class="user-info">
                    <span id="mobileName">Vendor</span>
                    <small>Shop Owner</small>
                </div>
            </div>

            <div class="sidebar-footer">
                <button id="logoutBtn" class="logout-btn">
                    <i data-lucide="log-out" class="nav-icon"></i>
                    Logout
                </button>
            </div>
        </div>
    </aside>

    <!-- Sidebar Overlay for Mobile -->
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <!-- Main Content -->
    <main class="admin-main">
        <!-- Header -->
        <header class="admin-header">
            <div class="header-actions">
                <button id="sidebarToggle" class="mobile-menu-btn">
                    <i data-lucide="menu"></i>
                </button>
                <h1 class="page-title">Vendor Dashboard</h1>
            </div>

            <div class="admin-user-profile">
                <div class="user-info">
                    <span id="headerName">Vendor</span>
                    <small>Shop Owner</small>
                </div>
                <div class="avatar" id="headerAvatar"><img src="" alt="Profile"></div>
            </div>
        </header>

        <!-- Dynamic Content -->
        <div class="admin-content" id="dashboard-content" style="display:none;">

            <!-- Tab Content Screens -->
            <div id="pending-verification-screen" style="display:none;">
                <div class="verification-lockdown-card animate-enter">
                    <div class="lockdown-header">
                        <div class="lockdown-icon-wrapper">
                            <i data-lucide="shield-alert" class="lockdown-icon"></i>
                        </div>
                        <h2 class="lockdown-title">Account Verification Pending</h2>
                        <p class="lockdown-subtitle">Your shop is currently under review by our administration team.</p>
                    </div>

                    <div class="verification-steps">
                        <div class="v-step completed">
                            <div class="v-step-icon"><i data-lucide="user-plus"></i></div>
                            <div class="v-step-content">
                                <h6>Account Created</h6>
                                <p>Successfully registered as a vendor.</p>
                            </div>
                        </div>
                        <div class="v-step active">
                            <div class="v-step-icon"><i data-lucide="clock"></i></div>
                            <div class="v-step-content">
                                <h6>Admin Review</h6>
                                <p>We are verifying your shop details and documents.</p>
                            </div>
                        </div>
                        <div class="v-step pending">
                            <div class="v-step-icon"><i data-lucide="check-circle"></i></div>
                            <div class="v-step-content">
                                <h6>Marketplace Live</h6>
                                <p>Start receiving orders and managing your menu!</p>
                            </div>
                        </div>
                    </div>

                    <div class="lockdown-footer">
                        <div class="info-box">
                            <i data-lucide="info"></i>
                            <span>Processing usually takes 24-48 hours. We'll notify you via email once approved.</span>
                        </div>
                        <button onclick="logoutUser()" class="btn-logout-lockdown">
                            <i data-lucide="log-out"></i> Logout
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tab: Shop Profile -->
            <div id="shop-tab" class="tab-content active">

                <!-- VIEW MODE -->
                <div id="shopViewMode">
                    <div class="content-card animate-enter">
                        <div class="card-header card-header-flex">
                            <h3 class="card-title">My Shop Profile</h3>
                            <button id="editProfileBtn" class="modern-btn btn-edit">
                                <i data-lucide="pencil"></i>
                                Edit Profile
                            </button>
                        </div>
                        <div class="card-body">
                            <!-- Profile Header with Image -->
                            <div class="shop-profile-header shop-profile-header-flex">
                                <div id="shopProfilePic" class="shop-avatar">
                                    <img src="https://via.placeholder.com/120?text=Shop" alt="Shop">
                                </div>
                                <div class="shop-profile-content">
                                    <h2 id="viewShopName" class="shop-name">Shop Name</h2>
                                    <p class="shop-meta shop-meta-flex">
                                        <i data-lucide="store"></i>
                                        Shop Owner
                                    </p>
                                </div>
                            </div>

                            <!-- Shop Details -->
                            <div class="categories-section">
                                <h4 class="shop-categories-title categories-title">Categories</h4>
                                <div id="viewCategories" class="categories-list">
                                    <span class="cat-chip cat-chip-empty">No
                                        categories</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- EDIT MODE -->
                <div id="shopEditMode" style="display:none;">
                    <div class="content-card">
                        <div class="card-header card-header-flex">
                            <h3 class="card-title">Edit Shop Profile</h3>
                            <button id="cancelEditBtn" class="modern-btn btn-cancel">
                                <i data-lucide="x"></i>
                                Cancel
                            </button>
                        </div>
                        <div class="form-section">
                            <form id="shopForm" class="modern-form">
                                <!-- Image Upload -->
                                <div class="form-group">
                                    <label>Profile Picture</label>
                                    <div class="image-upload-area">
                                        <input type="file" id="shopImageInput" accept="image/*"
                                            class="image-input-hidden">

                                        <!-- Upload Placeholder -->
                                        <div class="upload-placeholder" id="uploadPlaceholder">
                                            <i data-lucide="upload" class="upload-icon"></i>
                                            <p>Click to upload shop image</p>
                                        </div>
                                        <div id="imagePreview" class="image-preview">
                                            <img id="previewImg" src="" alt="Preview" class="preview-image">
                                            <button id="removeImageBtn" type="button"
                                                class="change-image-btn">Change</button>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="shopName">Shop Name</label>
                                    <input type="text" id="shopName" class="modern-input"
                                        placeholder="e.g. Tasty Burgers" required>
                                </div>

                                <div class="form-group">
                                    <label>Shop Categories</label>
                                    <div id="categoryContainer" class="category-container-flex">
                                        <!-- Categories rendered here -->
                                    </div>
                                    <div class="category-input-group">
                                        <select id="categorySelect" class="modern-input">
                                            <option value="">Select category...</option>
                                            <option value="Fast Food">Fast Food</option>
                                            <option value="Desi">Desi</option>
                                            <option value="Chinese">Chinese</option>
                                            <option value="Drinks">Drinks</option>
                                            <option value="Desserts">Desserts</option>
                                            <option value="custom">+ Add Custom</option>
                                        </select>
                                        <input id="customCategoryInput" type="text"
                                            class="modern-input custom-category-input"
                                            placeholder="Type custom category...">
                                        <button id="addCategoryBtn" type="button"
                                            class="modern-btn btn-add-category">Add</button>
                                    </div>
                                    <input type="hidden" id="finalCategoryList" name="categoryList" required>
                                </div>

                                <button type="submit" id="saveShopBtn" class="modern-btn btn-primary">Save Shop
                                    Details</button>
                            </form>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Tab: items -->
            <div id="items-tab" class="tab-content" style="display:none;">
                <div class="items-header">
                    <h2 class="items-title">My Menu Items</h2>
                    <button class="modern-btn btn-primary btn-add-item"
                        onclick="document.getElementById('itemModal').style.display='flex'">
                        <i data-lucide="plus-circle"></i> Add New Item
                    </button>
                </div>

                <div id="items-list" class="items-grid">
                    <!-- Items Grid -->
                </div>
            </div>

            <!-- Tab: Orders -->
            <div id="orders-tab" class="tab-content" style="display:none;">
                <div class="items-header">
                    <h2 class="items-title">Incoming Orders</h2>
                </div>

                <div id="orders-container">
                    <div class="loading" style="text-align: center; padding: 40px; color: var(--gray-500);">
                        <p>Loading orders...</p>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <!-- Add/Edit Item Modal -->
    <div id="itemModal" class="modal-overlay">
        <div class="content-card modal-dialog">
            <div class="card-header card-header-flex">
                <h3 id="modalTitle" class="card-title">Add New Item</h3>
                <button onclick="document.getElementById('itemModal').style.display='none'"
                    class="modern-btn modal-close-btn">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body-padding">
                <form id="itemForm" class="modern-form">
                    <div class="form-group">
                        <label>Item Name</label>
                        <input type="text" name="name" class="modern-input" required>
                    </div>
                    <div class="form-group">
                        <label>Price</label>
                        <input type="number" name="price" class="modern-input" required>
                    </div>
                    <div class="form-group">
                        <label>Item Image</label>
                        <div class="image-upload-area" id="itemUploadArea">
                            <input type="file" id="itemImageInput" accept="image/*" class="image-input-hidden">

                            <!-- Upload Placeholder -->
                            <div class="upload-placeholder" id="itemUploadPlaceholder">
                                <i data-lucide="upload" class="upload-icon"></i>
                                <p>Click to upload item image</p>
                            </div>

                            <!-- Preview Container -->
                            <div id="itemImagePreview" class="image-preview" style="display:none;">
                                <img id="itemPreviewImg" src="" alt="Item Preview" class="preview-image">
                                <button id="itemRemoveImageBtn" type="button" class="change-image-btn">Change</button>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Select Category</label>
                        <div id="itemCategoryChips" class="category-selection-area">
                            <!-- Populated from Shop Categories -->
                        </div>
                        <label>Category</label>
                        <div class="modal-category-group">
                            <input id="modalCategoryInput" type="text" name="category"
                                class="modern-input modal-category-input" placeholder="New category...">
                            <button id="modalAddCatBtn" type="button" class="modern-btn btn-add-modal-category">+
                                Add</button>
                        </div>
                        <input type="hidden" name="category" id="selectedItemCategory" required>
                    </div>
                    <button type="submit" id="addItemBtn" class="modern-btn btn-primary">Add Item</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Firebase -->
    <script type="module" src="vendor.js"></script>
    <!-- Init Lucide -->
    <script>
        lucide.createIcons();
    </script>
</body>

</html>